<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="urn:x-suse:xslt:profiling:docbook50-profile.xsl"
                 type="text/xml"
                 title="Profiling step"?>
<!DOCTYPE article
[
  <!ENTITY % entities SYSTEM "generic-entities.ent">
    %entities;
]>
<article xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="article-administration-slemicro" xml:lang="en">
 <title>Cockpit Guide</title>
 <info>
  <productnumber>&productnumber;</productnumber><productname>&productname;</productname><date>
<?dbtimestamp format="B d, Y"?></date>
  <abstract>
   <para>
    This guide describes the administration of &slem; using Cockpit.
   </para>
  </abstract>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker></dm:bugtracker>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 <section xml:id="sec-about-cockpit">
  <title>About Cockpit</title>
 </section>

<section xml:id="sec-getting-cockpit">
  <title>Getting Cockpit</title>
  <para>
    Cockpit is included in the delivered
   pre-built images, or can be installed if you are installing your own
   instances manually. For details regarding the manual installation, refer to
   <xref linkend="sec-settings-software"/>.
  </para>
  <para>
   Though Cockpit is present in the pre-built images by default, the plugin for
   administration of virtual machines needs to be installed manually. You can
   do so by installing the <literal>microos-cockpit</literal> pattern as
   described bellow. Use the command below as well in case Cockpit is not
   installed on your system.
  </para>
  <screen>&prompt.root;transactional-update pkg install -t pattern microos-cockpit</screen>
  <para>
   Reboot your machine to switch to the latest snapshot.
  </para>
  <note>
   <title>Cockpit's plugins installed from the <literal>microos-cockpit</literal> pattern may differ according to technologies installed on your system</title>
   <para>
    The plugin <literal>Podman containers</literal> is installed only if the
    <emphasis>Containers Runtime for non-clustered systems</emphasis> patterns
    are installed on your system. Similarly, the <literal>Virtual
    Machines</literal> plugin is installed only if the <emphasis>KVM
    Virtualization Host</emphasis> pattern is installed on your system.
   </para>
  </note>
  <para>
   Before running Cockpit on you machine, you need to enable the cockpit socket
   in systemd by running:
  </para>
<screen>&prompt.root;systemctl enable --now cockpit.socket</screen>
  <para>
   In case you have enabled the firewall, you also must open the firewall for
   Cockpit as follows:
  </para>
<screen>&prompt.root;firewall-cmd --permanent --zone=public --add-service=cockpit</screen>
  <para>
   And then reload the firewall configuration by running:
  </para>
<screen>&prompt.root;firewall-cmd --reload</screen>
  <para>
   Now you can access the Cockpit web interface by opening the following
   address in your web browser:
  </para>
<screen>https://<replaceable>IP_ADDRESS_OF_MACHINE</replaceable>:9090</screen>
 </section>

<section xml:id="sec-authentication">
  <title>Cockpit authentication</title>
  <section xml:id="sec-authentication-login">
    <title>Authentication</title>
    <para>
      Cockpit enables you to log in to each machine that can expose the 9090 port. If the port cannot be accessed on the particular machine, you can still use Cockpit to administer the machine by using it as a secondary server. For a procedure of adding a server as secondary, refer to <xref linkend="sec-adding-servers"/>. 
    </para>
    <para>
      Though Cockpit enables you to login and administer your machines directly, usually only one primary server is sufficient. After logging in to the primary server, you can switch to a secondary server. Aternatively, you can access secondary servers via a Cockpit bridge without the need to login to the primary server&mdash;the field <guimenu>Connect to</guimenu> is used for this puspose. 
    </para>

    <section xml:id="sec-adding-servers">
      <title>Adding secondary servers</title>
    </section>
  </section>

  <section xml:id="sec-cockpit-logs">
    <title>&slema; logs</title>
  </section>

  <section xml:id="sec-cockpit-networking">
    <title>Managing networking</title>
  </section>

  <section xml:id="sec-cockpit-containers">
    <title>Working with containers</title>
  </section>

  <section xml:id="sec-users-cockpit">
   <title>Users administration</title>
   <note>
    <title>Users administration only for server administrators</title>
    <para>
     Only users with the <guimenu>Server administrator</guimenu> role can edit
     other users.
    </para>
   </note>
   <para>
    Cockpit enables you to manage users of your system. Click
    <guimenu>Accounts</guimenu> to open the user administration page. Here you
    can create a new account by clicking <guimenu>Create new account</guimenu>
    or manage already existing accounts by clicking on the particular account.
   </para>
   <figure>
    <title>The <guimenu>Accounts</guimenu> screen</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="cockpit_accounts_screen.png" width="100%"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="cockpit_accounts_screen.png" width="100%"/>
     </imageobject>
    </mediaobject>
   </figure>
   <section xml:id="sec-adding-users">
    <title>Creating new accounts</title>
    <para>
     Click <guimenu>Create new account</guimenu> to open the window that
     enables you to add a new user. Fill in the user's login and/or full name
     and password, then confirm the form by clicking <guimenu>Create</guimenu>.
    </para>
    <para>
     To add authorized SSH keys for the new user or set the <guimenu>Server
     administrator</guimenu> role, edit the already created account by clicking
     on it. For details, refer to <xref linkend="sec-modifying-users"/>.
    </para>
   </section>
   <section xml:id="sec-modifying-users">
    <title>Modifying accounts</title>
    <para>
     After clicking the user icon in the <guimenu>Accounts</guimenu> page, the
     user details view opens and you can edit the user.
    </para>
    <figure>
     <title>User details</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="cockpit_user_details.png" width="100%"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="cockpit_user_details.png" width="100%"/>
      </imageobject>
     </mediaobject>
    </figure>
    <para>
     In the user's details view, you perform the following actions.
    </para>
    <variablelist>
     <varlistentry>
      <term>Delete the user</term>
      <listitem>
       <para>
        Click <guimenu>Delete</guimenu> to remove the user from the system.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Terminate user's session</term>
      <listitem>
       <para>
        By clicking <guimenu>Terminate session</guimenu>, you can log out the
        particular user of the system.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Change user's role</term>
      <listitem>
       <para>
        By checking/unchecking the <guimenu>Server administrator</guimenu>
        check box, you can assign or remove the administrator role from the
        user.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Manage access to the account</term>
      <listitem>
       <para>
        You can lock the account or you can set a date when the account will
        expire.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Manage the user's password</term>
      <listitem>
       <para>
        Click <guimenu>Set password</guimenu> to set a new password for the
        account.
       </para>
       <para>
        By clicking <guimenu>Force change</guimenu>, the user will have to
        change the password on the next login.
       </para>
       <para>
        Click <guimenu>edit</guimenu> to set whether or when the password
        expires.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Add SSH key</term>
      <listitem>
       <para>
        You can add a SSH key for passwordless authentication via SSH. Click
        <guimenu>Add key</guimenu>, paste the contents of the public SSH key
        and confirm it by clicking <guimenu>Add</guimenu>.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </section>
  </section>

  <section xml:id="sec-cockpit-services">
    <title>Managing services</title>
  </section>

  <section xml:id="sec-cockpit-updates">
   <title>Managing &slema; updates and snapshots</title>
   <note>
    <title>Snapshots and updates management only for system administrators</title>
    <para>
     Only users with the <guimenu>Server administrator</guimenu> role can
     update the system or perform a rollback to another snapshot.
    </para>
   </note>
   <para>
    Cockpit enables you to update your &slema; instance or perform a rollback
    from the <literal>Software Updates</literal> menu.
   </para>
   <figure>
    <title>Software Updates</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="cockpit_software_updates.png" width="100%"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="cockpit_software_updates.png" width="100%"/>
     </imageobject>
     <textobject role="description">
   <phrase>Software Updates view</phrase>
  </textobject>
    </mediaobject>
   </figure>
   <section xml:id="sec-cockpit-updates-procedure">
    <title>Managing updates</title>
    <para>
     Click <guimenu>Check for Updates</guimenu> to get a list of new package
     updates and patches available for your system. You can view each package
     update or patch information by clicking the blue icon next to the package
     update/patch. It is recommended to install the patches marked as important
     as soon as possible.
    </para>
    <para>
     To apply the updates and patches, click <guimenu>Update and
     Reboot</guimenu>. The equivalent of the <command>transactional-update up</command>
     command is called and a new snapshot of your system is created. After the update
     completes successfully, your system will be rebooted and the new snapshot
     set as default.
    </para>
    <para>
     You can postpone the reboot of your system after the update process by
     selecting <guimenu>Update without Reboot</guimenu> from the three-dot
     menu. Bear in mind that you need to reboot the system to activate the
     snapshot with updates. If you perform further changes without rebooting
     the system beforehand, a new snapshot will be created from the same point
     as the snapshots with updates. Therefore, the new snapshot will not include
     the updates.
    </para>
    <para>
     You can also update &slema; using CLI. For details, refer to
     <xref linkend="sec-command-list"/>.
    </para>
   </section>
   <section xml:id="sec-cockpit-rollback">
    <title>Performing rollbacks</title>
    <para>
     In <literal>Snapshots &amp; Updates</literal> you can perform a rollback
     to one of older snapshots by clicking <guimenu>Rollback and
     Reboot</guimenu>, or <guimenu>Rollback without Reboot</guimenu> in
     three-dot menu.
    </para>
    <para>
     After rebooting the system, the snapshot you rolled back to will be set as
     active. Do not make any changes (install updates, packages, etc.) before
     rebooting your system, as the snapshot you rolled back to is not active.
     Any changes performed before you reboot your system will start from the
     currently active snapshot.
    </para>
    <para>
     For a system rollback procedure performed using CLI, refer to
     <xref linkend="sec-rollback-procedure"/>.
    </para>
   </section>
  </section>
 
</section>

</article>