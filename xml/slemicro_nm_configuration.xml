<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter
[
  <!ENTITY % entities SYSTEM "generic-entities.ent">
    %entities;
]>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="cha-nm-configuration" xml:lang="en">
 <title>NetworkManager configuration and usage</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker></dm:bugtracker>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
  <abstract>
    <para>
      &nm; is shipped so it can run out of the box, but you might need to reconfigure or restart the tool. This chapter focuses on these tasks.
    </para>
  </abstract>
 </info>

<para>
  &nm; stores all network configuration as a connection, which is a collection of data, that describe how to create or connect to a network. These connections are stored as files in the <filename>/etc/NetworkManager/system-connections/</filename>.
</para>
<para>
  A connection is active when a particular device uses the connection. The device may have more than one connections configured, but only one can be active at the given time. The other connections can be used to fast switching to another one, for example, if the active connection is not available, &nm; tries to connect the device to another configured connection.
</para>
<para>
  To manage connections you can use the <command>nmcli</command>, described in the section below.
  </para>
  <para>
    To change how &nm; behaves, change or add values to the configuration file described in <xref linkend="sec-networkmanager-conf"/>.
  </para>

<section xml:id="sec-nmcli-interface">
  <title>The <command>nmcli</command> command</title>
<para>
  The &nm; provides a CLI interface to manage your connections. You can connect to a particular network by using the <command>nmcli</command> interface, or edit a connection. The generic syntax is as follows:
</para>
<screen>&prompt.root;nmcli <replaceable>OPTIONS</replaceable> <replaceable>SUBCOMMAND</replaceable> <replaceable>SUBCOMMAND_ARGUMENTS</replaceable></screen>
<para>
  Where <replaceable>OPTIONS</replaceable> are described in <xref linkend="sec-nmcli-options"/> and <replaceable>SUBCOMMAND</replaceable> can be any of the following:
  </para>
  <variablelist>
    <varlistentry>
      <term><command>connection</command></term>
      <listitem>
        <para>
          enables you to configure network. For details, refer to <!-- <xref linkend=""/>. -->
        </para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><command>device</command></term>
      <listitem>
        <para>
          For details, refer to <!-- <xref linkend=""/> -->
        </para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><command>general</command></term>
      <listitem>
        <para>shows status and permissions. For details refer to <!-- <xref linkend=""/> -->.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><command>monitor</command></term>
      <listitem>
        <para>
          monitors activity of &nm; and watches for changes in the state of connectivity and devices. This subcommand does not take any arguments.
        </para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><command>networking</command></term>
      <listitem>
        <para>querries the networking status. For details refer to <xref linkend="sec-connection-sommand"/>.</para>
      </listitem>
    </varlistentry>
    </variablelist>

    <section xml:id="sec-nmcli-options">
      <title>The <command>nmcli</command> command options</title>
      <para>
        Besides the subcommands and their arguments, the <command>nmcli</command> command can take the following options:
      </para>
      <variablelist>
        <varlistentry>
          <term><option>-a|--ask</option></term>
          <listitem>
            <para>
              the command will stop its run to ask for any missing arguments, for example, for a password to connect to a password.
            </para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>-c|--color {yes|no|auto}</option></term>
          <listitem>
            <para>
              controls the color output: <literal>yes</literal> to enable the colors, <literal>no</literal> to disable them, <literal>auto</literal> creates color output only when the standard output is directed to a terminal.
            </para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>-m|--mode {tabular|multiline}</option></term>
          <listitem>
            <para>
              switches between <literal>table</literal> (each line describes a single entry, columns define particular properties of the entry) and <literal>multiline</literal> (each entry comprises more lines, each property is on its own line). <literal>tabular</literal> is the default value.
            </para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>-h|--help</option></term>
          <listitem>
            <para>
              prints the help.
            </para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><option>-w|--wait seconds</option></term>
          <listitem>
            <para>
              sets a time-out period for which to wait for &nm; to finish operations. Using this option is recommended for commands that might take longer to complete, for example, connection activation.
            </para>
          </listitem>
        </varlistentry>
      </variablelist>
    </section>

    <section xml:id="sec-connection-sommand">
      <title>The <command>connection</command> subcommand</title>
      <para>
        The <command>connection</command> command enables you to manage connections or view any information about particular connections. The <command>nmcli connection</command> provides the following commands to manage your network connections: 
      </para>
      <variablelist>
        <varlistentry>
          <term><command>show</command></term>
          <listitem>
            <para>
              use this command to list connections:
            </para>
            <screen>&prompt.root;nmcli connection show</screen>
            <para>
             You can use this command also to show details about a specified connection:
           </para>
           <screen>&prompt.root;nmcli connection show <replaceable>CONNECTION_ID</replaceable></screen>
           <para>
            where <replaceable>CONNECTION_ID</replaceable> is any of the identifier: <emphasis>a connection name, UUID, or a path</emphasis>
           </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><command>up</command> or <command>down</command></term>
          <listitem>
            <para>
              to activate the provided connection. Use the command to activate the connection also after you perform any change to the connection.
            </para>
            <screen>&prompt.root;nmcli connection up <replaceable>CONNECTION_ID</replaceable></screen>
            <para>
              To deactivate the provided connection:
            </para>
            <screen>&prompt.root;nmcli connection down <replaceable>CONNECTION_ID</replaceable></screen>
            <para>
            where <replaceable>CONNECTION_ID</replaceable> is any of the identifier: <emphasis>a connection name, UUID, or a path</emphasis>
           </para>
            </listitem>
        </varlistentry>
        <varlistentry>
          <term><command>modify</command></term>
          <listitem>
            <para>
              to change or delete a property of a connection.
            </para>
            <screen>&prompt.root;nmcli connection modify <replaceable>CONNECTION_ID</replaceable> <replaceable>SETTING.PROPERTY</replaceable> <replaceable>PROPERTY_VALUE</replaceable></screen>
            <para>
            where:
          </para>
          <itemizedlist>
            <listitem>
              <para>
                <replaceable>CONNECTION_ID</replaceable> is any of the identifier: <emphasis>a connection name, UUID, or a path</emphasis>
              </para>
            </listitem>
            <listitem>
              <para>
                <replaceable>SETTING.PROPERTY</replaceable> is the name of the property, for example, <literal>ipv4.addresses</literal>.
              </para>
            </listitem>
            <listitem>
              <para>
                <replaceable>PROPERTY_VALUE</replaceable> is the desired value of <replaceable>SETTING.PROPERTY</replaceable>.
              </para>
            </listitem>
          </itemizedlist>
             </listitem>
        </varlistentry>
        <varlistentry>
          <term><command>add</command></term>
          <listitem>
            <para>
              to add a connection with the provided details. The command syntax is similar to the <command>modify</command> command, but you need to at least set the <literal>connection.type</literal> property:
          </para> 
          <screen>&prompt.root;nmcli connection add <replaceable>CONNECTION_ID</replaceable> <replaceable>save YES|NO</replaceable> <replaceable>SETTING.PROPERTY</replaceable> <replaceable>PROPERTY_VALUE</replaceable></screen>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><command>edit</command></term>
          <listitem>
            <para>
              to edit an existing connection using an interactive editor.
            </para>
            <screen>&prompt.root;nmcli connection edit <replaceable>CONNECTION_ID</replaceable></screen>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><command>clone</command></term>
          <listitem>
            <para>
              to clone an already existing connection. The minimal syntax follows:
            </para>
            <screen>&prompt.root;nmcli connection clone <replaceable>CONNECTION_ID</replaceable> <replaceable>NEW_NAME</replaceable></screen>
            <para>
              where <replaceable>CONNECTION_ID</replaceable> is the connection to be cloned.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><command>delete</command></term>
          <listitem>
            <para>
              to delete an existing connection:
            </para>
            <screen>&prompt.root;nmcli connection delete <replaceable>CONNECTION_ID</replaceable></screen>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><command>monitor</command></term>
          <listitem>
            <para>
              to monitor the provided connection.Each time the connection changes, &nm; prints a line.
            </para>
            <screen>&prompt.root;nmcli connection monitor <replaceable>CONNECTION_ID</replaceable></screen>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><command>reload</command></term>
          <listitem>
            <para>
              to reload all connections files from the disk. As &nm; does not monitor changes performed to the connection files, you need to use this command whenever you make changes to the files. This command does not any further arguments.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><command>load</command></term>
          <listitem>
            <para>
              to load/reload a particular connection file, run:
            </para>
            <screen>&prompt.root;nmcli connection load <replaceable>CONNECTION_FILE</replaceable></screen>
          </listitem>
        </varlistentry>
      </variablelist>
      <para>
        For details about the above mentioned commands, refer to the <link xlink:href="https://developer-old.gnome.org/NetworkManager/stable/nmcli.html"><command>nmcli</command> documentation</link>.
      </para>
    </section>

</section>



<section xml:id="sec-networkmanager-conf">
  <title>The <filename>NetworkManager.conf</filename> configuration file</title>
  <para>
    The main configuration file for the &nm; is <filename>/etc/NetworkManager/NetworkManager.conf</filename>. This file can be used to configure behavior of &nm;.
  </para>
  <para>
    The file consists of sections of key-value pairs. Each key-value pair must belong to a section. A section starts with a name enclosed in <emphasis>[]</emphasis>. Lines beginning with a <emphasis>#</emphasis> are considered comments. The minimal configuration needs to include the <literal>[main]</literal> section with the <literal>plugins</literal> value:
  </para>
  <screen>
    [main]
plugins=keyfile
  </screen>
  <para>
   The <literal>keyfile</literal> plugin supports all the connection types and capabilities of &nm;.
  </para>
  <para>
    The default configuration files contains the <literal>connectivity</literal> section that specifies the URI to check the network connection.
  </para>
  <para>
    On &slema; you can also use other sections, for details, refer to <link xlink:href="https://linux.die.net/man/5/networkmanager.conf">networkmanager.conf(5)</link> or <link xlink:href="https://developer-old.gnome.org/NetworkManager/stable/NetworkManager.conf.html">Gnome's eveloper guide</link>.
  </para>
  
</section>

</chapter>